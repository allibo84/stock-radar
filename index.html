<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Stock Radar">
    <meta name="theme-color" content="#27352a">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Stock Radar">
    <meta name="description" content="Gestion de stock e-commerce">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <title>Stock Radar</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-gradient: linear-gradient(135deg, #f5f6f8 0%, #ebedf2 100%);
            --card-bg: #ffffff; --text-color: #2c3e50; --text-secondary: #7f8c9b;
            --input-bg: #f8f9fb; --input-border: #dce1e8;
            --header-bg: rgba(39, 53, 42, 0.95); --filter-bg: #f0f2f5;
            --table-hover: #f5f7fa; --table-border: #e8ecf0;
            --sidebar-bg: linear-gradient(180deg, #27352a 0%, #1e2d22 100%);
        }
        body.dark-theme {
            --bg-gradient: linear-gradient(135deg, #1a1e2e 0%, #141722 100%);
            --card-bg: #222738; --text-color: #e0e4ec; --text-secondary: #8890a4;
            --input-bg: #2a2f42; --input-border: #3a4058;
            --header-bg: rgba(26, 30, 46, 0.95); --filter-bg: #262b3d;
            --table-hover: #2a2f45; --table-border: #343952;
            --sidebar-bg: linear-gradient(180deg, #1a1e2e 0%, #141722 100%);
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg-gradient); min-height: 100vh; color: var(--text-color); }
        #login-container { display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }
        .login-box { background: var(--card-bg); padding: 40px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); max-width: 400px; width: 100%; text-align: center; color: var(--text-color); }
        .login-logo { width: 250px; margin-bottom: 30px; }
        .login-box h2 { color: #27352a; margin-bottom: 10px; }
        .login-box p { color: var(--text-secondary); margin-bottom: 30px; }
        .login-form { text-align: left; }
        .login-form input { width: 100%; padding: 15px; margin-bottom: 15px; border: 2px solid var(--input-border); border-radius: 10px; font-size: 16px; background: var(--input-bg); color: var(--text-color); }
        .login-form input:focus { outline: none; border-color: #27352a; }
        .login-form button { width: 100%; padding: 15px; background: linear-gradient(135deg, #27352a, #3d5c42); color: white; border: none; border-radius: 10px; font-size: 18px; cursor: pointer; }
        .login-form button:hover { opacity: 0.9; }
        .login-error { color: #e74c3c; font-size: 14px; margin-bottom: 15px; display: none; }
        #app-container { display: none; }
        .header { background: var(--header-bg); backdrop-filter: blur(10px); color: white; padding: 15px 25px; display: flex; align-items: center; justify-content: space-between; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .header-left { display: flex; align-items: center; gap: 15px; }
        .hamburger { background: none; border: none; color: white; font-size: 24px; cursor: pointer; display: flex; flex-direction: column; gap: 4px; padding: 5px; }
        .hamburger span { display: block; width: 22px; height: 2px; background: white; transition: 0.3s; }
        .header-logo { height: 40px; }
        .header h1 { font-size: 20px; font-weight: 700; letter-spacing: 1px; }
        .header-right { display: flex; align-items: center; gap: 15px; }
        .dark-toggle { background: none; border: none; color: white; font-size: 20px; cursor: pointer; }
        .sync-indicator { display: flex; align-items: center; gap: 5px; font-size: 13px; opacity: 0.8; }
        .sync-dot { width: 8px; height: 8px; border-radius: 50%; background: #2ecc71; }
        .user-email { font-size: 13px; opacity: 0.8; }
        .logout-btn { background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 13px; }
        .sidebar { position: fixed; left: -280px; top: 0; width: 280px; height: 100vh; background: var(--sidebar-bg); z-index: 200; transition: left 0.3s ease; box-shadow: 5px 0 20px rgba(0,0,0,0.3); overflow-y: auto; }
        .sidebar.open { left: 0; }
        .sidebar-header { padding: 25px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .sidebar-logo { width: 200px; }
        .menu-items { padding: 20px 0; }
        .menu-item { display: flex; align-items: center; gap: 12px; padding: 14px 25px; color: rgba(255,255,255,0.7); cursor: pointer; transition: all 0.2s; font-size: 15px; }
        .menu-item:hover { background: rgba(255,255,255,0.1); color: white; }
        .menu-item.active { background: rgba(255,255,255,0.15); color: white; border-left: 3px solid #9fdd65; font-weight: 600; }
        .menu-item-icon { font-size: 20px; }
        .menu-sub-item { padding-left: 45px; font-size: 14px; }
        .menu-sub-item .menu-item-icon { font-size: 16px; }
        .menu-section-label { padding: 12px 25px 4px; color: rgba(255,255,255,0.3); font-size: 11px; text-transform: uppercase; letter-spacing: 2px; }
        .overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 150; display: none; }
        .sidebar.open ~ .overlay { display: block; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .tab-content { display: none; animation: fadeIn 0.3s ease; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
        .section-header h2 { font-size: 22px; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .stat-card { background: var(--card-bg); border-radius: 12px; padding: 20px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.08); }
        .stat-number { font-size: 28px; font-weight: 700; color: #27352a; }
        .stat-label { font-size: 13px; color: var(--text-secondary); margin-top: 5px; }
        .loading { text-align: center; padding: 60px 20px; }
        .loading-spinner { border: 4px solid #ddd; border-top: 4px solid #27352a; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .form-group { margin-bottom: 18px; }
        .form-group label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 14px; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; border: 2px solid var(--input-border); border-radius: 10px; font-size: 15px; background: var(--input-bg); color: var(--text-color); }
        .form-group textarea { min-height: 80px; resize: vertical; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .form-row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; }
        .submit-button { width: 100%; padding: 15px; background: linear-gradient(135deg, #27352a, #3d5c42); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; }
        .submit-button:hover { opacity: 0.9; }
        .scan-button { display: inline-flex; align-items: center; gap: 8px; padding: 10px 20px; background: linear-gradient(135deg, #27352a, #3d5c42); color: white; border: none; border-radius: 10px; font-size: 14px; cursor: pointer; font-weight: 500; }
        .scan-button:hover { opacity: 0.9; }
        .scan-button.export { background: linear-gradient(135deg, #2980b9, #3498db); }
        .scan-button.reset { background: linear-gradient(135deg, #7f8c8d, #95a5a6); }
        .scan-button.danger { background: linear-gradient(135deg, #c0392b, #e74c3c); }
        .scan-section { background: var(--card-bg); padding: 25px; border-radius: 15px; text-align: center; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); }
        #video-container { margin-top: 15px; }
        #video { max-width: 100%; border-radius: 10px; display: none; }
        .search-filters { background: var(--filter-bg); padding: 20px; border-radius: 12px; margin-bottom: 20px; }
        .search-row { display: flex; gap: 10px; flex-wrap: wrap; }
        .search-input { padding: 10px 15px; border: 2px solid var(--input-border); border-radius: 10px; font-size: 14px; background: var(--input-bg); color: var(--text-color); min-width: 150px; flex: 1; }
        .products-table { overflow-x: auto; background: var(--card-bg); border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); -webkit-overflow-scrolling: touch; }
        table { width: 100%; border-collapse: collapse; font-size: 14px; }
        th { background: var(--filter-bg); padding: 12px 15px; text-align: left; font-weight: 600; color: var(--text-secondary); border-bottom: 2px solid var(--table-border); white-space: nowrap; }
        td { padding: 12px 15px; border-bottom: 1px solid var(--table-border); }
        tr:hover { background: var(--table-hover); }
        .badge { padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        .badge-stock { background: #e8f5e9; color: #2e7d32; }
        .badge-sold { background: #e3f2fd; color: #1565c0; }
        .badge-invendable { background: #fce4ec; color: #c62828; }
        .badge-fba { background: #fff3e0; color: #e65100; }
        .badge-fbm { background: #e8eaf6; color: #283593; }
        .badge-entrepot { background: #f3e5f5; color: #6a1b9a; }
        .badge-neuf { background: #e8f5e9; color: #2e7d32; }
        .badge-occasion { background: #fff8e1; color: #f57f17; }
        .badge-rebut { background: #fce4ec; color: #c62828; }
        .action-buttons { display: flex; gap: 5px; flex-wrap: wrap; }
        .btn-small { padding: 6px 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 500; }
        .btn-small:hover { opacity: 0.8; }
        .btn-sold { background: #27ae60; color: white; }
        .btn-vinted { background: #00b4b6; color: white; }
        .btn-leboncoin { background: #f56b2a; color: white; }
        .btn-delete { background: #e74c3c; color: white; }
        .btn-edit { background: #3498db; color: white; }
        .btn-fba { background: #ff9900; color: white; }
        .marge-indicator { padding: 3px 8px; border-radius: 8px; font-size: 12px; font-weight: 600; }
        .marge-high { background: #d4edda; color: #155724; }
        .marge-medium { background: #fff3cd; color: #856404; }
        .marge-low { background: #f8d7da; color: #721c24; }
        .success-message { display: none; background: #d4edda; color: #155724; padding: 15px; border-radius: 10px; text-align: center; font-weight: 600; margin-bottom: 20px; }
        .info-message { background: #d1ecf1; color: #0c5460; padding: 12px 15px; border-radius: 10px; margin-bottom: 15px; font-size: 14px; }
        .calc-display { background: var(--filter-bg); padding: 8px 12px; border-radius: 8px; font-size: 13px; color: var(--text-secondary); margin-top: 5px; }
        .checkbox-group { display: flex; gap: 20px; flex-wrap: wrap; }
        .checkbox-group label { display: flex; align-items: center; gap: 6px; font-weight: normal; cursor: pointer; }
        .photo-upload { border: 2px dashed var(--input-border); border-radius: 10px; padding: 20px; text-align: center; cursor: pointer; }
        .photo-preview { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
        .photo-preview img { width: 80px; height: 80px; object-fit: cover; border-radius: 8px; cursor: pointer; }
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.6); z-index: 300; overflow-y: auto; padding: 20px; -webkit-overflow-scrolling: touch; }
        .modal-content { background: var(--card-bg); border-radius: 15px; padding: 30px; max-width: 700px; margin: 40px auto; position: relative; color: var(--text-color); }
        .modal-content.wide { max-width: 900px; }
        .close-modal { position: absolute; top: 15px; right: 20px; font-size: 28px; cursor: pointer; color: var(--text-secondary); }
        .empty-state { text-align: center; padding: 60px 20px; color: var(--text-secondary); }
        .empty-state h3 { margin: 15px 0 10px; color: var(--text-color); }
        .charts-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        .chart-card { background: var(--card-bg); border-radius: 15px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); }
        .chart-card h3 { margin-bottom: 15px; font-size: 16px; }
        .annonce-preview { background: var(--filter-bg); padding: 20px; border-radius: 10px; font-size: 14px; white-space: pre-wrap; margin: 15px 0; max-height: 300px; overflow-y: auto; }
        .copy-button { background: #27352a; color: white; border: none; padding: 12px 25px; border-radius: 10px; cursor: pointer; font-size: 14px; width: 100%; }
        /* Product detail */
        .detail-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        .detail-item { background: var(--filter-bg); padding: 12px 16px; border-radius: 8px; }
        .detail-label { font-size: 12px; color: var(--text-secondary); margin-bottom: 4px; }
        .detail-value { font-size: 16px; font-weight: 600; }
        .qte-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin: 15px 0; }
        .qte-card { background: var(--filter-bg); padding: 15px; border-radius: 10px; text-align: center; }
        .qte-card .qte-num { font-size: 24px; font-weight: 700; }
        .qte-card .qte-label { font-size: 12px; color: var(--text-secondary); margin-top: 4px; }
        /* Stock tab pills */
        .stock-pills { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px; }
        .stock-pill { padding: 10px 20px; border-radius: 25px; border: 2px solid var(--input-border); background: var(--card-bg); color: var(--text-color); cursor: pointer; font-weight: 600; font-size: 14px; transition: all 0.2s; }
        .stock-pill:hover { border-color: #9fdd65; }
        .stock-pill.active { background: #27352a; color: white; border-color: #27352a; }
        /* Global search */
        .header-center { flex: 1; max-width: 450px; margin: 0 15px; }
        .global-search-wrapper { position: relative; }
        .global-search-wrapper input { width: 100%; padding: 8px 15px; border: 2px solid rgba(255,255,255,0.2); border-radius: 25px; background: rgba(255,255,255,0.1); color: white; font-size: 14px; outline: none; transition: all 0.3s; }
        .global-search-wrapper input::placeholder { color: rgba(255,255,255,0.5); }
        .global-search-wrapper input:focus { border-color: rgba(255,255,255,0.5); background: rgba(255,255,255,0.15); }
        .global-search-dropdown { position: absolute; top: 100%; left: 0; right: 0; background: var(--card-bg); border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); max-height: 400px; overflow-y: auto; z-index: 300; margin-top: 5px; }
        .search-result-item { padding: 12px 15px; cursor: pointer; border-bottom: 1px solid var(--table-border); display: flex; justify-content: space-between; align-items: center; }
        .search-result-item:hover { background: var(--table-hover); }
        .search-result-item:last-child { border-bottom: none; }
        .search-result-type { font-size: 11px; padding: 2px 8px; border-radius: 10px; font-weight: 600; }
        .search-result-type.stock { background: #27352a; color: white; }
        .search-result-type.achat { background: #ff9900; color: white; }
        .search-result-type.fournisseur { background: #3f51b5; color: white; }
        /* Advanced filters */
        .filters-advanced { display: none; padding: 15px; background: var(--filter-bg); border-radius: 10px; margin-top: 10px; }
        .filters-advanced.show { display: block; }
        .filters-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-bottom: 10px; }
        .filter-group label { display: block; font-size: 12px; font-weight: 600; color: var(--text-secondary); margin-bottom: 4px; }
        .filter-group select, .filter-group input { width: 100%; padding: 8px; border: 1px solid var(--input-border); border-radius: 8px; background: var(--input-bg); color: var(--text-color); font-size: 13px; }
        .btn-toggle-filters { background: none; border: 2px solid var(--input-border); color: var(--text-color); padding: 8px 15px; border-radius: 20px; cursor: pointer; font-size: 13px; font-weight: 600; }
        .btn-toggle-filters.active { background: #27352a; color: white; border-color: #27352a; }
        /* Scan feedback */
        .scan-feedback { position: fixed; top: 80px; left: 50%; transform: translateX(-50%); padding: 15px 30px; border-radius: 12px; font-weight: 700; font-size: 16px; z-index: 500; animation: scanPop 0.5s ease; }
        .scan-feedback.ok { background: #27ae60; color: white; }
        .scan-feedback.ko { background: #e74c3c; color: white; }
        .scan-feedback.doublon { background: #f39c12; color: white; }
        @keyframes scanPop { 0% { transform: translateX(-50%) scale(0.5); opacity: 0; } 100% { transform: translateX(-50%) scale(1); opacity: 1; } }
        /* Risk badge */
        .badge-risk { background: #e74c3c; color: white; padding: 2px 8px; border-radius: 10px; font-size: 11px; font-weight: 600; }
        .badge-slow { background: #f39c12; color: white; padding: 2px 8px; border-radius: 10px; font-size: 11px; font-weight: 600; }
        /* Alert badges */
        .alert-critique { background: #e74c3c; color: white; padding: 4px 10px; border-radius: 8px; font-size: 12px; font-weight: 700; }
        .alert-bas { background: #f39c12; color: white; padding: 4px 10px; border-radius: 8px; font-size: 12px; font-weight: 700; }
        .alert-ok { background: #27ae60; color: white; padding: 4px 10px; border-radius: 8px; font-size: 12px; font-weight: 700; }
        /* Inventory */
        .inv-row { display: grid; grid-template-columns: 1fr 2fr 80px 80px 80px 100px; gap: 10px; align-items: center; padding: 12px 15px; border-bottom: 1px solid var(--table-border); }
        .inv-row:hover { background: var(--table-hover); }
        .inv-row.ecart { background: rgba(231,76,60,0.08); }
        .inv-row.ok { background: rgba(39,174,96,0.05); }
        .inv-input { width: 70px; padding: 6px; text-align: center; border: 2px solid var(--input-border); border-radius: 8px; background: var(--input-bg); color: var(--text-color); font-weight: 700; font-size: 14px; }
        .inv-input:focus { border-color: #3498db; outline: none; }
        .inv-input.ecart { border-color: #e74c3c; background: rgba(231,76,60,0.1); }
        .inv-input.ok { border-color: #27ae60; }
        /* Fournisseur fiche */
        .fournisseur-card { background: var(--card-bg); padding: 20px; border-radius: 15px; margin-bottom: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); cursor: pointer; transition: transform 0.2s; }
        .fournisseur-card:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0,0,0,0.12); }
        .fournisseur-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .fournisseur-details { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 8px; font-size: 13px; }
        .fournisseur-detail { color: var(--text-secondary); }
        .fournisseur-detail strong { color: var(--text-color); }
        /* Facture badges */
        .badge-payee { background: #27ae60; color: white; padding: 3px 10px; border-radius: 10px; font-size: 12px; font-weight: 600; }
        .badge-impayee { background: #e74c3c; color: white; padding: 3px 10px; border-radius: 10px; font-size: 12px; font-weight: 600; }
        .badge-retard { background: #f39c12; color: white; padding: 3px 10px; border-radius: 10px; font-size: 12px; font-weight: 600; }
        /* Aide / Guide */
        .help-section { margin-bottom: 30px; }
        .help-card { background: var(--card-bg); border-radius: 15px; padding: 0; box-shadow: 0 2px 10px rgba(0,0,0,0.06); overflow: hidden; margin-bottom: 12px; }
        .help-card-header { padding: 18px 22px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: 700; font-size: 15px; transition: background 0.2s; }
        .help-card-header:hover { background: var(--filter-bg); }
        .help-card-header .help-icon { font-size: 20px; margin-right: 12px; }
        .help-card-header .help-chevron { transition: transform 0.3s; color: var(--text-secondary); }
        .help-card-header.open .help-chevron { transform: rotate(180deg); }
        .help-card-body { display: none; padding: 0 22px 22px; line-height: 1.7; color: var(--text-secondary); font-size: 14px; }
        .help-card-body.open { display: block; }
        .help-card-body p { margin-bottom: 10px; }
        .help-card-body strong { color: var(--text-color); }
        .help-step { display: flex; gap: 12px; margin-bottom: 12px; align-items: flex-start; }
        .help-step-num { background: #27352a; color: white; min-width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 13px; flex-shrink: 0; }
        .help-step-text { flex: 1; }
        .help-tip { background: var(--filter-bg); border-left: 4px solid #27352a; padding: 12px 16px; border-radius: 0 8px 8px 0; margin: 12px 0; font-size: 13px; }
        .help-tip strong { color: #27352a; }
        .help-shortcut { display: inline-flex; align-items: center; gap: 6px; margin: 3px 4px; }
        .help-shortcut kbd { background: var(--filter-bg); border: 1px solid var(--input-border); padding: 2px 8px; border-radius: 5px; font-size: 12px; font-family: monospace; font-weight: 600; }
        .help-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin: 15px 0; }
        .help-feature { background: var(--filter-bg); padding: 15px; border-radius: 10px; }
        .help-feature-title { font-weight: 700; color: var(--text-color); margin-bottom: 6px; font-size: 14px; }
        @media (max-width: 768px) {
            .header h1 { font-size: 16px; }
            .header-center { display: none; }
            .header-right { gap: 6px; }
            .header-right .sync-indicator span,
            .header-right .user-email { display: none; }
            .header-right .logout-btn { font-size: 12px; padding: 6px 10px; }
            #admin-switcher select { max-width: 140px; font-size: 11px; }
            .form-row, .form-row-3 { grid-template-columns: 1fr; }
            .stats { grid-template-columns: repeat(2, 1fr); gap: 8px; }
            .stat-card { padding: 12px 8px; }
            .stat-number { font-size: 18px; }
            .stat-label { font-size: 11px; }
            .charts-grid { grid-template-columns: 1fr; }
            .tab-content { padding: 15px 10px; }
            .section-header { flex-direction: column; gap: 10px; align-items: flex-start; }
            .section-header h2 { font-size: 18px; }
            .detail-grid { grid-template-columns: 1fr; }
            .qte-grid { grid-template-columns: 1fr; }
            .filters-row { grid-template-columns: 1fr 1fr; }
            .filter-group { min-width: unset; }
            /* Tables mobile */
            .products-table { font-size: 12px; }
            .products-table th, .products-table td { padding: 8px 6px; font-size: 12px; }
            /* Modal mobile */
            .modal-content { margin: 10px; padding: 20px 15px; max-width: 100%; border-radius: 12px; max-height: 90vh; overflow-y: auto; }
            .modal-content.wide { max-width: 100%; }
            /* Stock pills */
            .stock-pills { flex-wrap: wrap; gap: 6px; }
            .stock-pill { padding: 6px 12px; font-size: 12px; }
            /* Search filters */
            .search-filters { padding: 12px; }
            .search-row { flex-direction: column; gap: 8px; }
            .search-input { min-width: unset; width: 100%; }
            /* Filters advanced */
            .filters-advanced { padding: 12px; }
            .filters-row { gap: 8px; }
            /* Buttons */
            .scan-button { padding: 8px 12px; font-size: 13px; }
            .submit-button { padding: 14px; font-size: 15px; }
            /* Inventaire grid */
            .inv-row { grid-template-columns: 1fr 1.5fr 50px 60px 50px 50px; gap: 4px; padding: 8px; font-size: 11px; }
            .inv-input { width: 50px; padding: 4px; font-size: 12px; }
            /* Help */
            .help-grid { grid-template-columns: 1fr; }
            .help-card-header { padding: 14px 16px; font-size: 14px; }
            .help-card-body { padding: 0 16px 16px; font-size: 13px; }
            /* Fournisseur cards */
            .fournisseur-details { grid-template-columns: 1fr; }
            .fournisseur-card { padding: 15px; }
            /* Export grid */
            .export-grid { grid-template-columns: 1fr !important; }
            /* Mobile search show */
            #mobile-search { display: block !important; }
            /* Bottom safe area for PWA */
            .tab-content { padding-bottom: 30px; }
        }
        
        @media (max-width: 380px) {
            .stats { grid-template-columns: 1fr; }
            .header h1 { font-size: 14px; }
            .header-logo { width: 28px; height: 28px; }
            .inv-row { grid-template-columns: 1fr 1.2fr 40px 50px 40px 40px; font-size: 10px; }
        }

        /* PWA standalone mode */
        @media (display-mode: standalone) {
            body { padding-top: env(safe-area-inset-top); }
            .header { padding-top: env(safe-area-inset-top); }
        }
        /* Floating scan button mobile */
        .fab-scan { display: none; position: fixed; bottom: 25px; right: 20px; width: 60px; height: 60px; border-radius: 50%; background: #27352a; color: white; border: none; font-size: 28px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); z-index: 200; cursor: pointer; transition: transform 0.2s; }
        .fab-scan:active { transform: scale(0.9); }
        @media (max-width: 768px) { .fab-scan { display: flex; align-items: center; justify-content: center; } }
        /* Quick scan overlay */
        .quick-scan-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.95); z-index: 400; flex-direction: column; align-items: center; justify-content: flex-start; padding-top: env(safe-area-inset-top, 20px); }
        .quick-scan-overlay.active { display: flex; }
        .quick-scan-header { width: 100%; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; color: white; }
        .quick-scan-header h3 { font-size: 18px; }
        .quick-scan-close { background: none; border: none; color: white; font-size: 32px; cursor: pointer; padding: 5px; }
        .quick-scan-video-box { width: 100%; max-width: 500px; position: relative; border-radius: 15px; overflow: hidden; margin: 10px 20px; }
        .quick-scan-video-box video { width: 100%; display: block; border-radius: 15px; }
        .quick-scan-viewfinder { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 70%; height: 40%; border: 3px solid rgba(39,174,96,0.8); border-radius: 12px; box-shadow: 0 0 0 9999px rgba(0,0,0,0.3); }
        .quick-scan-result { width: 100%; padding: 15px 20px; text-align: center; color: white; font-size: 16px; font-weight: 700; min-height: 60px; display: flex; align-items: center; justify-content: center; }
        .quick-scan-result.ok { color: #2ecc71; }
        .quick-scan-result.doublon { color: #f39c12; }
        .quick-scan-result.ko { color: #e74c3c; }
        .quick-scan-actions { padding: 10px 20px; width: 100%; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
        .quick-scan-actions button { padding: 12px 20px; border-radius: 10px; border: none; font-size: 14px; font-weight: 700; cursor: pointer; }
        .quick-scan-history { width: 100%; padding: 10px 20px; max-height: 200px; overflow-y: auto; }
        .quick-scan-history-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; margin-bottom: 4px; border-radius: 8px; background: rgba(255,255,255,0.08); color: white; font-size: 13px; }
    </style>
</head>
<body>
    <div id="login-container">
        <div class="login-box">
            <img src="logo.png" alt="Stock Radar" class="login-logo">
            <h2>Connexion</h2>
            <p>G√©rez votre stock intelligent</p>
            <div class="login-error" id="login-error"></div>
            <form class="login-form" id="login-form">
                <input type="email" id="login-email" placeholder="Email" required>
                <input type="password" id="login-password" placeholder="Mot de passe" required>
                <button type="submit">Se connecter</button>
            </form>
        </div>
    </div>

    <div id="app-container">
        <header class="header">
            <div class="header-left">
                <button class="hamburger" onclick="document.getElementById('sidebar').classList.toggle('open'); document.getElementById('overlay').style.display=document.getElementById('sidebar').classList.contains('open')?'block':'none';">
                    <span></span><span></span><span></span>
                </button>
                <img src="logo.png" alt="Logo" class="header-logo" style="cursor:pointer;" onclick="switchTab('dashboard')">
                <h1 style="cursor:pointer;" onclick="switchTab('dashboard')">STOCK RADAR</h1>
            </div>
            <div class="header-center">
                <div class="global-search-wrapper">
                    <input type="text" id="global-search" placeholder="üîç Recherche globale (EAN, nom, fournisseur, notes...)" oninput="globalSearch(this.value)">
                    <div id="global-search-results" class="global-search-dropdown" style="display:none;"></div>
                </div>
            </div>
            <div class="header-right">
                <span id="admin-badge" style="display:none;background:#e74c3c;color:white;padding:3px 10px;border-radius:15px;font-size:11px;font-weight:700;">ADMIN</span>
                <div id="admin-switcher" style="display:none;align-items:center;gap:8px;"></div>
                <span id="viewing-indicator" style="display:none;background:#f39c12;color:white;padding:3px 10px;border-radius:15px;font-size:11px;font-weight:700;"></span>
                <button class="dark-toggle" id="dark-toggle" onclick="toggleDarkMode()">üåô</button>
                <div class="sync-indicator"><div class="sync-dot"></div><span>Synchronis√©</span></div>
                <span class="user-email" id="user-email"></span>
                <button class="logout-btn" onclick="logout()">D√©connexion</button>
            </div>
        </header>

        <div class="sidebar" id="sidebar">
            <div class="sidebar-header"><img src="logo.png" alt="Stock Radar" class="sidebar-logo"></div>
            <div class="menu-items">
                <div class="menu-item active" data-tab="dashboard">
                    <span class="menu-item-icon">üìä</span><span>Dashboard</span>
                </div>
                <div class="menu-section-label">Achats</div>
                <div class="menu-item" data-tab="fournisseurs">
                    <span class="menu-item-icon">üè™</span><span>Fournisseurs</span>
                </div>
                <div class="menu-item" data-tab="achats">
                    <span class="menu-item-icon">üõí</span><span>Mes Achats</span>
                </div>
                <div class="menu-item" data-tab="factures">
                    <span class="menu-item-icon">üßæ</span><span>Factures</span>
                </div>
                <div class="menu-item" data-tab="import-grossiste">
                    <span class="menu-item-icon">üì•</span><span>Import Grossiste</span>
                </div>
                <div class="menu-section-label">Stock</div>
                <div class="menu-item" data-tab="stock">
                    <span class="menu-item-icon">üì¶</span><span>Mon Stock</span>
                </div>
                <div class="menu-item" data-tab="nouveau-produit">
                    <span class="menu-item-icon">‚ûï</span><span>Nouveau Produit</span>
                </div>
                <div class="menu-item" data-tab="mouvements">
                    <span class="menu-item-icon">üìã</span><span>Journal Mouvements</span>
                </div>
                <div class="menu-item" data-tab="alertes">
                    <span class="menu-item-icon">üîî</span><span>Alertes Stock</span>
                </div>
                <div class="menu-item" data-tab="inventaire">
                    <span class="menu-item-icon">üìä</span><span>Inventaire</span>
                </div>
                <div class="menu-section-label">Outils</div>
                <div class="menu-item" data-tab="outils-export">
                    <span class="menu-item-icon">üì§</span><span>Export & Sauvegarde</span>
                </div>
                <div class="menu-item" data-tab="aide">
                    <span class="menu-item-icon">‚ùì</span><span>Aide & Guide</span>
                </div>
            </div>
            <div style="padding:15px 20px;border-top:1px solid rgba(255,255,255,0.1);margin-top:auto;">
                <div style="font-size:11px;color:rgba(255,255,255,0.4);">‚å®Ô∏è Raccourcis : Ctrl+N Nouveau ¬∑ Ctrl+F Recherche ¬∑ Ctrl+S Scan</div>
            </div>
        </div>

        <div class="overlay" id="overlay" onclick="document.getElementById('sidebar').classList.remove('open'); this.style.display='none';"></div>
        
        <!-- Scan feedback popup -->
        <div id="scan-feedback" class="scan-feedback" style="display:none;"></div>

        <!-- Mobile search (hidden on desktop) -->
        <div style="padding:10px 15px;display:none;" id="mobile-search">
            <div class="global-search-wrapper">
                <input type="text" id="global-search-mobile" placeholder="üîç Recherche globale..." oninput="globalSearch(this.value, true)">
                <div id="global-search-results-mobile" class="global-search-dropdown" style="display:none;"></div>
            </div>
        </div>

        <div class="container">
            <div class="loading" id="loading"><div class="loading-spinner"></div><p>Chargement des donn√©es...</p></div>
            <div id="main-content" style="display:none;">

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DASHBOARD ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="dashboard" class="tab-content active">
                    <div class="section-header"><h2>üìä Vue d'ensemble</h2></div>
                    <div class="stats">
                        <div class="stat-card"><div class="stat-number" id="dash-total-produits">0</div><div class="stat-label">Produits en stock</div></div>
                        <div class="stat-card"><div class="stat-number" id="dash-total-vendus">0</div><div class="stat-label">Vendus</div></div>
                        <div class="stat-card"><div class="stat-number" id="dash-valeur-stock">0‚Ç¨</div><div class="stat-label">Valeur stock (co√ªt)</div></div>
                        <div class="stat-card"><div class="stat-number" id="dash-valeur-entrepot">0‚Ç¨</div><div class="stat-label">Valeur entrep√¥t</div></div>
                        <div class="stat-card"><div class="stat-number" id="dash-ca-realise">0‚Ç¨</div><div class="stat-label">CA r√©alis√©</div></div>
                        <div class="stat-card"><div class="stat-number" id="dash-benefice">0‚Ç¨</div><div class="stat-label">B√©n√©fice</div></div>
                        <div class="stat-card"><div class="stat-number" id="dash-marge-moyenne">0%</div><div class="stat-label">Marge moyenne</div></div>
                    </div>
                    <div class="stats" style="grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));">
                        <div class="stat-card" style="border-left:4px solid #ff9900;"><div class="stat-number" id="dash-qte-fba">0</div><div class="stat-label">FBA</div></div>
                        <div class="stat-card" style="border-left:4px solid #3f51b5;"><div class="stat-number" id="dash-qte-fbm">0</div><div class="stat-label">FBM</div></div>
                        <div class="stat-card" style="border-left:4px solid #9c27b0;"><div class="stat-number" id="dash-qte-entrepot">0</div><div class="stat-label">Entrep√¥t</div></div>
                        <div class="stat-card" style="border-left:4px solid #f44336;"><div class="stat-number" id="dash-qte-rebut">0</div><div class="stat-label">Rebut</div></div>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-card"><h3>üìà √âvolution mensuelle</h3><canvas id="chartEvolution" height="200"></canvas></div>
                        <div class="chart-card"><h3>üì¶ R√©partition stock</h3><canvas id="chartRepartition" height="200"></canvas></div>
                        <div class="chart-card"><h3>üèÜ Top 5 cat√©gories</h3><canvas id="chartCategories" height="200"></canvas></div>
                        <div class="chart-card"><h3>üí∞ CA par canal</h3><canvas id="chartCanaux" height="200"></canvas></div>
                    </div>
                </div>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FOURNISSEURS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="fournisseurs" class="tab-content">
                    <div class="section-header">
                        <h2>üè™ Fournisseurs</h2>
                        <button class="scan-button" onclick="document.getElementById('fournisseur-form-section').style.display=document.getElementById('fournisseur-form-section').style.display==='none'?'block':'none'">‚ûï Ajouter</button>
                    </div>
                    <div id="fournisseur-form-section" style="display:none; background:var(--card-bg); padding:25px; border-radius:15px; margin-bottom:20px; box-shadow:0 2px 10px rgba(0,0,0,0.08);">
                        <form id="fournisseur-form">
                            <div class="form-row">
                                <div class="form-group"><label>Nom *</label><input type="text" id="f-nom" required></div>
                                <div class="form-group"><label>Contact</label><input type="text" id="f-contact"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Email</label><input type="email" id="f-email"></div>
                                <div class="form-group"><label>T√©l√©phone</label><input type="tel" id="f-tel"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Adresse</label><input type="text" id="f-adresse"></div>
                                <div class="form-group"><label>Site web</label><input type="url" id="f-siteweb" placeholder="https://..."></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>SIRET</label><input type="text" id="f-siret" placeholder="N¬∞ SIRET"></div>
                                <div class="form-group"><label>TVA Intracommunautaire</label><input type="text" id="f-tva" placeholder="FR..."></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Conditions paiement</label><input type="text" id="f-conditions" placeholder="Ex: 30 jours fin de mois"></div>
                                <div class="form-group"><label>D√©lai livraison</label><input type="text" id="f-delai" placeholder="Ex: 5-7 jours"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>MOQ (minimum de commande)</label><input type="number" id="f-moq" min="0" value="0"></div>
                                <div class="form-group"><label>Franco de port (‚Ç¨)</label><input type="number" id="f-franco" step="0.01" min="0" value="0"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Cat√©gorie fournisseur</label>
                                    <select id="f-categorie-fournisseur">
                                        <option value="">--</option>
                                        <option value="Grossiste">Grossiste</option>
                                        <option value="Fabricant">Fabricant</option>
                                        <option value="Distributeur">Distributeur</option>
                                        <option value="Marketplace">Marketplace</option>
                                        <option value="Particulier">Particulier</option>
                                        <option value="Autre">Autre</option>
                                    </select>
                                </div>
                                <div class="form-group"></div>
                            </div>
                            <div class="form-group"><label>Notes</label><textarea id="f-notes"></textarea></div>
                            <button type="submit" class="submit-button">üíæ Enregistrer</button>
                        </form>
                    </div>
                    <div id="fournisseurs-container"></div>
                </div>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ACHATS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="achats" class="tab-content">
                    <div class="section-header">
                        <h2>üõí Mes Achats</h2>
                        <div style="display:flex;gap:10px;flex-wrap:wrap;">
                            <button class="scan-button" onclick="toggleAchatForm()">‚ûï Nouvel achat</button>
                            <button class="scan-button export" onclick="exportAchatsCSV()">üìä Export CSV</button>
                        </div>
                    </div>
                    <div id="achat-form-section" style="display:none; background:var(--card-bg); padding:25px; border-radius:15px; margin-bottom:20px; box-shadow:0 2px 10px rgba(0,0,0,0.08);">
                        <form id="achat-form">
                            <div class="form-row"><div class="form-group"><label>EAN *</label><input type="text" id="a-ean" required></div><div class="form-group"><label>Nom *</label><input type="text" id="a-nom" required></div></div>
                            <div class="form-row"><div class="form-group"><label>Cat√©gorie</label><select id="a-categorie"><option value="">--</option><option>√âlectronique</option><option>Informatique</option><option>Mode</option><option>Maison</option><option>Beaut√©</option><option>Sport</option><option>Jouets</option><option>Livres</option><option>Auto</option><option>Bricolage</option><option>Autre</option></select></div><div class="form-group"><label>Fournisseur</label><select id="a-fournisseur"><option value="">--</option></select></div></div>
                            <div class="form-row">
                                <div class="form-group"><label>Prix unitaire HT</label><input type="number" id="a-prix-ht" step="0.01" oninput="calculateTTC()" placeholder="Prix par unit√© HT"></div>
                                <div class="form-group"><label>Prix unitaire TTC</label><input type="number" id="a-prix-ttc" step="0.01" oninput="calculateHT()" placeholder="Prix par unit√© TTC"></div>
                            </div>
                            <div class="form-row"><div class="form-group"><label>Quantit√©</label><input type="number" id="a-quantite" min="1" value="1"></div><div class="form-group"><label>Date</label><input type="date" id="a-date"></div></div>
                            <div class="form-group"><label>Notes</label><textarea id="a-notes"></textarea></div>
                            <button type="submit" class="submit-button">üíæ Enregistrer</button>
                        </form>
                    </div>
                    <div class="search-filters">
                        <div class="search-row">
                            <input type="text" class="search-input" id="search-achats" placeholder="üîç Rechercher...">
                            <select class="search-input" id="filter-achat-fournisseur"><option value="">Tous fournisseurs</option></select>
                            <select class="search-input" id="filter-achat-recu"><option value="">Tous</option><option value="oui">‚úÖ Re√ßu</option><option value="non">‚è≥ En attente</option></select>
                        </div>
                    </div>
                    <div class="stats" id="achats-stats">
                        <div class="stat-card"><div class="stat-number" id="achats-total">0</div><div class="stat-label">Total achats</div></div>
                        <div class="stat-card"><div class="stat-number" id="achats-montant">0‚Ç¨</div><div class="stat-label">Montant total</div></div>
                        <div class="stat-card"><div class="stat-number" id="achats-en-attente">0</div><div class="stat-label">En attente</div></div>
                    </div>
                    <div id="achats-container"></div>
                </div>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FACTURES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="factures" class="tab-content">
                    <div class="section-header">
                        <h2>üßæ Factures</h2>
                        <button class="scan-button" onclick="toggleFactureForm()">‚ûï Nouvelle facture</button>
                    </div>
                    <div id="facture-form-section" style="display:none; background:var(--card-bg); padding:25px; border-radius:15px; margin-bottom:20px; box-shadow:0 2px 10px rgba(0,0,0,0.08);">
                        <form id="facture-form">
                            <div class="form-row">
                                <div class="form-group"><label>N¬∞ Facture *</label><input type="text" id="fac-numero" required placeholder="FAC-2026-001"></div>
                                <div class="form-group"><label>Fournisseur *</label><select id="fac-fournisseur" required><option value="">--</option></select></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Date facture</label><input type="date" id="fac-date"></div>
                                <div class="form-group"><label>Date √©ch√©ance</label><input type="date" id="fac-echeance"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Montant HT (‚Ç¨)</label><input type="number" id="fac-montant-ht" step="0.01" oninput="document.getElementById('fac-montant-ttc').value=(parseFloat(this.value||0)*1.20).toFixed(2)"></div>
                                <div class="form-group"><label>Montant TTC (‚Ç¨)</label><input type="number" id="fac-montant-ttc" step="0.01" oninput="document.getElementById('fac-montant-ht').value=(parseFloat(this.value||0)/1.20).toFixed(2)"></div>
                            </div>
                            <div class="form-group"><label>Notes</label><textarea id="fac-notes" placeholder="D√©tails, r√©f√©rence commande..."></textarea></div>
                            <button type="submit" class="submit-button">üíæ Enregistrer</button>
                        </form>
                    </div>
                    <div class="stats" id="factures-stats">
                        <div class="stat-card"><div class="stat-number" id="fac-total">0</div><div class="stat-label">Factures</div></div>
                        <div class="stat-card"><div class="stat-number" id="fac-montant">0‚Ç¨</div><div class="stat-label">Montant total TTC</div></div>
                        <div class="stat-card" style="border-left:4px solid #e74c3c;"><div class="stat-number" id="fac-impayees">0</div><div class="stat-label">Impay√©es</div></div>
                        <div class="stat-card" style="border-left:4px solid #f39c12;"><div class="stat-number" id="fac-montant-du">0‚Ç¨</div><div class="stat-label">Montant d√ª</div></div>
                    </div>
                    <div id="factures-container"></div>
                </div>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê IMPORT GROSSISTE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="import-grossiste" class="tab-content">
                    <div class="section-header"><h2>üì• Import Grossiste</h2></div>
                    <div style="background:var(--card-bg); padding:25px; border-radius:15px; box-shadow:0 2px 10px rgba(0,0,0,0.08);">
                        <p style="color:var(--text-secondary); margin-bottom:15px;">Importez un fichier Excel ou CSV de votre commande grossiste. Les colonnes seront d√©tect√©es automatiquement.</p>
                        <div style="background:var(--filter-bg); padding:15px; border-radius:10px; margin-bottom:20px; font-size:13px; color:var(--text-secondary);">
                            <strong>Colonnes attendues :</strong> EAN/Code-barres, Nom/Titre, Prix (HT ou TTC), Quantit√©, Cat√©gorie (optionnel)
                        </div>
                        <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:15px;">
                            <label class="scan-button" style="cursor:pointer;"><span>üìÇ Choisir un fichier</span><input type="file" id="grossiste-file-input" accept=".xlsx,.xls,.csv" style="display:none;" onchange="previewGrossisteImport(this)"></label>
                            <span id="grossiste-file-name" style="color:var(--text-secondary); font-size:14px;"></span>
                        </div>
                        <div style="margin-bottom:15px;">
                            <label style="font-weight:600; margin-bottom:6px; display:block;">Emplacement par d√©faut :</label>
                            <select id="grossiste-emplacement" style="padding:10px; border:2px solid var(--input-border); border-radius:10px; background:var(--input-bg); color:var(--text-color);">
                                <option value="entrepot">üè≠ Entrep√¥t</option>
                                <option value="fba">üì¶ Amazon FBA</option>
                                <option value="fbm">üè† Amazon FBM</option>
                            </select>
                        </div>
                        <div id="grossiste-preview" style="display:none;">
                            <h3 style="margin-bottom:10px;">Aper√ßu de l'import</h3>
                            <div id="grossiste-preview-table" style="max-height:400px; overflow-y:auto;"></div>
                            <div style="display:flex; gap:10px; margin-top:15px;">
                                <button class="scan-button" onclick="confirmGrossisteImport()">‚úÖ Importer <span id="grossiste-count">0</span> produits</button>
                                <button class="scan-button reset" onclick="cancelGrossisteImport()">‚ùå Annuler</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê STOCK ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="stock" class="tab-content">
                    <div class="section-header">
                        <h2>üì¶ Mon Stock</h2>
                        <div style="display:flex;gap:10px;flex-wrap:wrap;">
                            <button class="scan-button" onclick="openQuickScan()">üì∑ Scanner</button>
                            <button class="scan-button" onclick="switchTab('nouveau-produit')">‚ûï Nouveau</button>
                            <button class="scan-button export" onclick="exportStockExcel()">üìä Export</button>
                        </div>
                    </div>
                    <!-- Pills sous-cat√©gories -->
                    <div class="stock-pills">
                        <button class="stock-pill active" data-stock="all" onclick="switchStockView('all')">üì¶ Tout</button>
                        <button class="stock-pill" data-stock="neuf" onclick="switchStockView('neuf')">üÜï Neuf</button>
                        <button class="stock-pill" data-stock="occasion" onclick="switchStockView('occasion')">‚ôªÔ∏è Occasion</button>
                        <button class="stock-pill" data-stock="entrepot" onclick="switchStockView('entrepot')">üè≠ Entrep√¥t</button>
                        <button class="stock-pill" data-stock="rebut" onclick="switchStockView('rebut')">üóëÔ∏è Rebut</button>
                    </div>
                    <!-- Filtres -->
                    <div class="search-filters">
                        <div class="search-row">
                            <input type="text" class="search-input" id="stock-search" placeholder="üîç Rechercher nom, EAN, fournisseur, notes..." oninput="displayStock()">
                            <select class="search-input" id="stock-sort" onchange="displayStock()">
                                <option value="date-desc">Date ‚Üì r√©cent</option>
                                <option value="date-asc">Date ‚Üë ancien</option>
                                <option value="qte-desc">Quantit√© ‚Üì</option>
                                <option value="qte-asc">Quantit√© ‚Üë</option>
                                <option value="prix-desc">Prix ‚Üì</option>
                                <option value="prix-asc">Prix ‚Üë</option>
                                <option value="nom-asc">Nom A‚ÜíZ</option>
                                <option value="marge-desc">Marge ‚Üì meilleure</option>
                                <option value="marge-asc">Marge ‚Üë pire</option>
                                <option value="roi-desc">ROI ‚Üì meilleur</option>
                                <option value="age-desc">Anciennet√© ‚Üì + vieux</option>
                                <option value="risk">‚ö†Ô∏è √Ä risque (vieux stock)</option>
                            </select>
                            <button class="btn-toggle-filters" id="btn-adv-filters" onclick="toggleAdvancedFilters()">‚öôÔ∏è Filtres</button>
                        </div>
                        <div class="filters-advanced" id="advanced-filters">
                            <div class="filters-row">
                                <div class="filter-group">
                                    <label>Cat√©gorie</label>
                                    <select id="stock-filter-cat" onchange="displayStock()">
                                        <option value="">Toutes</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Plateforme</label>
                                    <select id="stock-filter-canal" onchange="displayStock()">
                                        <option value="">Toutes</option>
                                        <option value="fba">Amazon FBA</option>
                                        <option value="fbm">Amazon FBM</option>
                                        <option value="vinted">Vinted</option>
                                        <option value="leboncoin">Leboncoin</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Emplacement</label>
                                    <select id="stock-filter-emplacement" onchange="displayStock()">
                                        <option value="">Tous</option>
                                        <option value="entrepot">Entrep√¥t seulement</option>
                                        <option value="fba">FBA seulement</option>
                                        <option value="fbm">FBM seulement</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Date depuis</label>
                                    <input type="date" id="stock-filter-date-from" onchange="displayStock()">
                                </div>
                                <div class="filter-group">
                                    <label>Date jusqu'√†</label>
                                    <input type="date" id="stock-filter-date-to" onchange="displayStock()">
                                </div>
                                <div class="filter-group">
                                    <label>Fournisseur</label>
                                    <select id="stock-filter-fournisseur" onchange="displayStock()">
                                        <option value="">Tous</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Statut</label>
                                    <select id="stock-filter-statut" onchange="displayStock()">
                                        <option value="">Tous</option>
                                        <option value="recu">üì¶ Re√ßu</option>
                                        <option value="a_controler">üîç √Ä contr√¥ler</option>
                                        <option value="a_etiqueter">üè∑Ô∏è √Ä √©tiqueter</option>
                                        <option value="a_expedier">üìÆ √Ä exp√©dier</option>
                                        <option value="envoye">üöÄ Envoy√©</option>
                                        <option value="termine">‚úÖ Termin√©</option>
                                    </select>
                                </div>
                            </div>
                            <div style="text-align:right;margin-top:5px;">
                                <button class="btn-toggle-filters" onclick="resetFilters()">üîÑ R√©initialiser</button>
                            </div>
                        </div>
                    </div>
                    <!-- Stats stock -->
                    <div class="stats" id="stock-stats">
                        <div class="stat-card"><div class="stat-number" id="stock-total">0</div><div class="stat-label">Produits</div></div>
                        <div class="stat-card"><div class="stat-number" id="stock-qte-total">0</div><div class="stat-label">Unit√©s</div></div>
                        <div class="stat-card"><div class="stat-number" id="stock-valeur-achat">0‚Ç¨</div><div class="stat-label">Valeur achat (co√ªt)</div></div>
                        <div class="stat-card"><div class="stat-number" id="stock-valeur-revente">0‚Ç¨</div><div class="stat-label">Valeur revente</div></div>
                        <div class="stat-card"><div class="stat-number" id="stock-valeur-entrepot">0‚Ç¨</div><div class="stat-label">Valeur entrep√¥t</div></div>
                        <div class="stat-card"><div class="stat-number" id="stock-benefice-potentiel">0‚Ç¨</div><div class="stat-label">B√©n√©fice potentiel</div></div>
                    </div>
                    <div id="stock-container"></div>
                </div>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NOUVEAU PRODUIT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="nouveau-produit" class="tab-content">
                    <div class="success-message" id="success-message">‚úÖ Produit ajout√© au stock !</div>
                    <div class="info-message" id="info-achat" style="display:none;">üí° <span id="info-achat-text"></span></div>
                    <div class="scan-section">
                        <h2>Scanner le code-barres</h2>
                        <p style="color:var(--text-secondary);font-size:13px;margin-bottom:15px;">Utilisez la cam√©ra de votre t√©l√©phone ou saisissez l'EAN manuellement</p>
                        <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
                            <button class="scan-button" onclick="startScanner()" style="padding:12px 25px;font-size:16px;">üì∑ Scanner avec la cam√©ra</button>
                            <button class="scan-button stop" id="stop-scanner" style="display:none;padding:12px 25px;font-size:16px;" onclick="stopScanner()">‚èπÔ∏è Arr√™ter</button>
                        </div>
                        <div id="video-container" style="margin-top:15px;position:relative;">
                            <video id="video" autoplay playsinline style="max-width:100%;border-radius:12px;"></video>
                        </div>
                    </div>
                    <form id="product-form">
                        <div class="form-group">
                            <label for="ean">EAN / ASIN *</label>
                            <div style="display:flex;gap:10px;">
                                <input type="text" id="ean" required placeholder="Saisir ou scanner" oninput="checkPurchaseHistory()" style="flex:1;">
                                <button type="button" class="btn-small" onclick="searchPrice('amazon')" style="background:#ff9900;color:white;padding:8px 15px;border-radius:8px;">Amazon</button>
                                <button type="button" class="btn-small" onclick="searchPrice('google')" style="background:#4285F4;color:white;padding:8px 15px;border-radius:8px;">Google</button>
                            </div>
                        </div>
                        <div class="form-group"><label for="product-name">Nom du produit *</label><input type="text" id="product-name" required placeholder="Ex: iPhone 13"></div>
                        <div class="form-row">
                            <div class="form-group"><label>Cat√©gorie *</label><select id="categorie" required><option value="">--</option><option value="√âlectronique">üì± √âlectronique</option><option value="Informatique">üíª Informatique</option><option value="Mode">üëï Mode</option><option value="Maison">üè† Maison</option><option value="Beaut√©">üíÑ Beaut√©</option><option value="Sport">‚öΩ Sport</option><option value="Jouets">üß∏ Jouets</option><option value="Livres">üìö Livres</option><option value="Auto">üöó Auto</option><option value="Bricolage">üîß Bricolage</option><option value="Autre">üì¶ Autre</option></select></div>
                            <div class="form-group"><label>√âtat produit *</label><select id="etat" required><option value="">--</option><option value="Neuf">Neuf</option><option value="Comme neuf">Comme neuf</option><option value="Tr√®s bon √©tat">Tr√®s bon</option><option value="Bon √©tat">Bon</option><option value="√âtat correct">Correct</option><option value="Pour pi√®ces">Pi√®ces</option></select></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group"><label>Type de stock *</label><select id="etat-stock" required><option value="neuf">üÜï Neuf</option><option value="occasion">‚ôªÔ∏è Occasion</option><option value="rebut">üóëÔ∏è Rebut</option></select></div>
                            <div class="form-group"></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Prix d'achat (‚Ç¨)</label>
                                <div style="display:flex;gap:10px;margin-bottom:8px;">
                                    <label style="display:flex;align-items:center;gap:5px;font-weight:normal;cursor:pointer;"><input type="radio" name="prix-type" id="prix-type-ht" value="ht" checked onchange="recalcPrixAchat()"> HT</label>
                                    <label style="display:flex;align-items:center;gap:5px;font-weight:normal;cursor:pointer;"><input type="radio" name="prix-type" id="prix-type-ttc" value="ttc" onchange="recalcPrixAchat()"> TTC</label>
                                </div>
                                <input type="number" id="prix-achat" step="0.01" placeholder="0.00" oninput="recalcPrixAchat()">
                                <div class="calc-display" id="prix-achat-conv" style="display:none;"></div>
                            </div>
                            <div class="form-group"><label>Prix revente (‚Ç¨) *</label><input type="number" id="prix-revente" step="0.01" required placeholder="0.00" oninput="calculateMarge()" style="margin-top:38px;"><div class="calc-display" id="marge-display" style="display:none;"></div></div>
                        </div>
                        <!-- R√©partition quantit√©s -->
                        <div style="background:var(--filter-bg); padding:20px; border-radius:12px; margin-bottom:18px;">
                            <label style="font-weight:600; margin-bottom:10px; display:block;">üì¶ R√©partition des quantit√©s</label>
                            <div class="form-row-3">
                                <div class="form-group"><label style="font-size:13px;">üè≠ Entrep√¥t</label><input type="number" id="qte-entrepot" min="0" value="0" oninput="updateTotalQte()"></div>
                                <div class="form-group"><label style="font-size:13px;">üì¶ Amazon FBA</label><input type="number" id="qte-fba" min="0" value="0" oninput="updateTotalQte()"></div>
                                <div class="form-group"><label style="font-size:13px;">üè† Amazon FBM</label><input type="number" id="qte-fbm" min="0" value="0" oninput="updateTotalQte()"></div>
                            </div>
                            <div id="total-qte-display" style="text-align:center; font-weight:700; font-size:16px; margin-top:5px;">Total : 0 unit√©s</div>
                        </div>
                        <!-- Canaux de vente -->
                        <div class="form-group">
                            <label>Canaux de vente</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" id="amazon_fba"> Amazon FBA</label>
                                <label><input type="checkbox" id="amazon_fbm"> Amazon FBM</label>
                                <label><input type="checkbox" id="vinted"> Vinted</label>
                                <label><input type="checkbox" id="leboncoin"> Leboncoin</label>
                            </div>
                        </div>
                        <div class="form-group"><label>Photos</label><div class="photo-upload" onclick="document.getElementById('photo-input').click()"><p>üì∏ Ajouter photos</p><input type="file" id="photo-input" accept="image/*" multiple style="display:none;" onchange="handlePhotoUpload(event)"></div><div class="photo-preview" id="photo-preview"></div></div>
                        <div class="form-group"><label for="notes">Notes</label><textarea id="notes" placeholder="Remarques..."></textarea></div>
                        <button type="submit" class="submit-button">üíæ Enregistrer</button>
                    </form>
                </div>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê JOURNAL MOUVEMENTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="mouvements" class="tab-content">
                    <div class="section-header"><h2>üìã Journal des mouvements</h2></div>
                    <p style="color:var(--text-secondary);margin-bottom:20px;">Historique de tous les mouvements de stock : r√©ceptions, transferts, ventes, ajustements.</p>
                    <div id="mouvements-container"></div>
                </div>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ALERTES STOCK ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="alertes" class="tab-content">
                    <div class="section-header">
                        <h2>üîî Alertes Stock Bas</h2>
                        <button class="scan-button" onclick="configurerSeuilsEnLot()">‚öôÔ∏è Configurer seuils en lot</button>
                    </div>
                    <p style="color:var(--text-secondary);margin-bottom:20px;">Produits dont la quantit√© est en dessous ou √©gale au seuil minimum d√©fini.</p>
                    
                    <div class="stats" id="alertes-stats">
                        <div class="stat-card" style="border-left:4px solid #e74c3c;"><div class="stat-number" id="alertes-critiques">0</div><div class="stat-label">üî¥ Critiques (= 0)</div></div>
                        <div class="stat-card" style="border-left:4px solid #f39c12;"><div class="stat-number" id="alertes-basses">0</div><div class="stat-label">üü† Stock bas</div></div>
                        <div class="stat-card" style="border-left:4px solid #27ae60;"><div class="stat-number" id="alertes-ok">0</div><div class="stat-label">üü¢ OK</div></div>
                        <div class="stat-card"><div class="stat-number" id="alertes-sans-seuil">0</div><div class="stat-label">‚ö™ Sans seuil</div></div>
                    </div>
                    <div id="alertes-container"></div>
                </div>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INVENTAIRE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="inventaire" class="tab-content">
                    <div class="section-header">
                        <h2>üìä Inventaire / Comptage</h2>
                        <div style="display:flex;gap:10px;flex-wrap:wrap;">
                            <button class="scan-button" onclick="startInventaire()">üÜï Nouvel inventaire</button>
                            <button class="scan-button export" id="btn-export-inventaire" onclick="exportInventaire()" style="display:none;">üì• Exporter √©carts</button>
                        </div>
                    </div>
                    <p style="color:var(--text-secondary);margin-bottom:20px;">Comparez le stock th√©orique avec un comptage physique. Scannez ou saisissez les quantit√©s r√©elles.</p>
                    
                    <div id="inventaire-mode" style="display:none;">
                        <div class="stats" id="inventaire-stats">
                            <div class="stat-card"><div class="stat-number" id="inv-total-produits">0</div><div class="stat-label">Produits √† compter</div></div>
                            <div class="stat-card"><div class="stat-number" id="inv-comptes">0</div><div class="stat-label">Compt√©s</div></div>
                            <div class="stat-card" style="border-left:4px solid #27ae60;"><div class="stat-number" id="inv-ok">0</div><div class="stat-label">‚úÖ Conformes</div></div>
                            <div class="stat-card" style="border-left:4px solid #e74c3c;"><div class="stat-number" id="inv-ecarts">0</div><div class="stat-label">‚ö†Ô∏è √âcarts</div></div>
                        </div>

                        <div style="background:var(--card-bg);padding:20px;border-radius:15px;margin-bottom:20px;box-shadow:0 2px 10px rgba(0,0,0,0.08);">
                            <h3 style="margin-bottom:15px;">üì∑ Scan rapide</h3>
                            <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;">
                                <input type="text" id="inv-scan-ean" placeholder="Scanner ou saisir un EAN..." style="flex:1;padding:10px;border-radius:8px;border:1px solid var(--input-border);background:var(--input-bg);color:var(--text-color);" onkeydown="if(event.key==='Enter'){inventaireScanEAN();}">
                                <button class="scan-button" onclick="inventaireScanEAN()">‚úÖ Compter</button>
                                <button class="scan-button" onclick="startInventaireScanner()">üì∑ Scanner</button>
                                <button class="scan-button stop" id="inv-stop-scanner" style="display:none;" onclick="stopInventaireScanner()">‚èπÔ∏è Stop</button>
                            </div>
                            <div id="inv-video-container" style="margin-top:10px;"><video id="inv-video" autoplay playsinline style="display:none;width:100%;max-width:400px;border-radius:10px;"></video></div>
                            <div id="inv-scan-feedback" style="margin-top:10px;font-weight:600;display:none;"></div>
                        </div>

                        <div style="display:flex;gap:10px;margin-bottom:15px;">
                            <button class="btn-toggle-filters" onclick="filterInventaire('all')">üì¶ Tous</button>
                            <button class="btn-toggle-filters" onclick="filterInventaire('ecarts')">‚ö†Ô∏è √âcarts seulement</button>
                            <button class="btn-toggle-filters" onclick="filterInventaire('non-comptes')">‚ùì Non compt√©s</button>
                        </div>
                        <div id="inventaire-container"></div>

                        <div style="margin-top:20px;display:flex;gap:10px;flex-wrap:wrap;">
                            <button class="scan-button" style="background:#27ae60;" onclick="validerInventaire()">‚úÖ Valider & ajuster le stock</button>
                            <button class="scan-button danger" onclick="annulerInventaire()">‚ùå Annuler</button>
                        </div>
                    </div>

                    <div id="inventaire-vide">
                        <div class="empty-state"><h3>Pas d'inventaire en cours</h3><p>Cliquez sur "Nouvel inventaire" pour d√©marrer un comptage.</p></div>
                    </div>
                </div>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EXPORT & SAUVEGARDE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="outils-export" class="tab-content">
                    <div class="section-header"><h2>üì§ Export & Sauvegarde</h2></div>
                    
                    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;">
                        <!-- Exports -->
                        <div style="background:var(--card-bg);padding:25px;border-radius:15px;box-shadow:0 2px 10px rgba(0,0,0,0.08);">
                            <h3 style="margin-bottom:15px;">üìä Export Excel / CSV</h3>
                            <p style="color:var(--text-secondary);margin-bottom:20px;font-size:14px;">Exporte les donn√©es filtr√©es ou compl√®tes dans diff√©rents formats.</p>
                            
                            <div style="margin-bottom:12px;">
                                <label style="font-weight:600;font-size:13px;display:block;margin-bottom:5px;">Que exporter ?</label>
                                <select id="export-type" class="search-input" style="width:100%;padding:10px;">
                                    <option value="stock-all">üì¶ Stock complet</option>
                                    <option value="stock-filtered">üì¶ Stock filtr√© (filtre actif)</option>
                                    <option value="stock-neuf">üÜï Stock Neuf uniquement</option>
                                    <option value="stock-occasion">‚ôªÔ∏è Stock Occasion uniquement</option>
                                    <option value="achats-all">üõí Tous les achats</option>
                                    <option value="achats-mois">üõí Achats du mois</option>
                                    <option value="fournisseurs">üè™ Fournisseurs</option>
                                    <option value="vendus">üí∞ Produits vendus</option>
                                    <option value="marge">üìà Rapport de marge</option>
                                </select>
                            </div>
                            <div style="margin-bottom:12px;">
                                <label style="font-weight:600;font-size:13px;display:block;margin-bottom:5px;">Format</label>
                                <select id="export-format" class="search-input" style="width:100%;padding:10px;">
                                    <option value="xlsx">Excel (.xlsx)</option>
                                    <option value="csv">CSV (.csv)</option>
                                </select>
                            </div>
                            <button class="scan-button export" onclick="exportAdvanced()" style="width:100%;justify-content:center;">üì• Exporter</button>
                        </div>
                        
                        <!-- Sauvegarde -->
                        <div style="background:var(--card-bg);padding:25px;border-radius:15px;box-shadow:0 2px 10px rgba(0,0,0,0.08);">
                            <h3 style="margin-bottom:15px;">üíæ Sauvegarde & Restauration</h3>
                            <p style="color:var(--text-secondary);margin-bottom:20px;font-size:14px;">Sauvegardez toutes vos donn√©es (produits, achats, fournisseurs) dans un fichier JSON. Utile avant une grosse modification.</p>
                            
                            <button class="scan-button" onclick="backupData()" style="width:100%;justify-content:center;margin-bottom:12px;">üì¶ Sauvegarder tout (JSON)</button>
                            
                            <div style="border-top:1px solid var(--input-border);padding-top:15px;margin-top:15px;">
                                <h4 style="margin-bottom:10px;">üîÑ Restaurer une sauvegarde</h4>
                                <p style="color:var(--text-secondary);font-size:13px;margin-bottom:10px;">‚ö†Ô∏è Cela va <strong>remplacer</strong> toutes les donn√©es actuelles par celles du fichier.</p>
                                <input type="file" id="restore-file" accept=".json" style="display:none;" onchange="restoreData(event)">
                                <button class="scan-button danger" onclick="document.getElementById('restore-file').click()" style="width:100%;justify-content:center;">üîÑ Restaurer depuis un fichier</button>
                            </div>
                        </div>

                        <!-- Raccourcis clavier -->
                        <div style="background:var(--card-bg);padding:25px;border-radius:15px;box-shadow:0 2px 10px rgba(0,0,0,0.08);">
                            <h3 style="margin-bottom:15px;">‚å®Ô∏è Raccourcis clavier</h3>
                            <p style="color:var(--text-secondary);margin-bottom:20px;font-size:14px;">Gagnez du temps avec les raccourcis.</p>
                            <div style="display:grid;gap:8px;">
                                <div style="display:flex;justify-content:space-between;padding:8px;background:var(--filter-bg);border-radius:8px;"><span>Nouveau produit</span><kbd style="background:var(--input-bg);padding:3px 8px;border-radius:4px;font-size:12px;border:1px solid var(--input-border);">Ctrl + N</kbd></div>
                                <div style="display:flex;justify-content:space-between;padding:8px;background:var(--filter-bg);border-radius:8px;"><span>Recherche globale</span><kbd style="background:var(--input-bg);padding:3px 8px;border-radius:4px;font-size:12px;border:1px solid var(--input-border);">Ctrl + F</kbd></div>
                                <div style="display:flex;justify-content:space-between;padding:8px;background:var(--filter-bg);border-radius:8px;"><span>Lancer le scanner</span><kbd style="background:var(--input-bg);padding:3px 8px;border-radius:4px;font-size:12px;border:1px solid var(--input-border);">Ctrl + S</kbd></div>
                                <div style="display:flex;justify-content:space-between;padding:8px;background:var(--filter-bg);border-radius:8px;"><span>Dashboard</span><kbd style="background:var(--input-bg);padding:3px 8px;border-radius:4px;font-size:12px;border:1px solid var(--input-border);">Ctrl + D</kbd></div>
                                <div style="display:flex;justify-content:space-between;padding:8px;background:var(--filter-bg);border-radius:8px;"><span>Mon Stock</span><kbd style="background:var(--input-bg);padding:3px 8px;border-radius:4px;font-size:12px;border:1px solid var(--input-border);">Ctrl + K</kbd></div>
                                <div style="display:flex;justify-content:space-between;padding:8px;background:var(--filter-bg);border-radius:8px;"><span>Exporter stock Excel</span><kbd style="background:var(--input-bg);padding:3px 8px;border-radius:4px;font-size:12px;border:1px solid var(--input-border);">Ctrl + E</kbd></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê AIDE & GUIDE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <div id="aide" class="tab-content">
                    <div class="section-header"><h2>‚ùì Aide & Guide complet</h2></div>
                    <p style="color:var(--text-secondary);margin-bottom:25px;font-size:15px;">Bienvenue dans Stock Radar ! Ce guide vous explique tout ce que vous pouvez faire avec l'application.</p>

                    <!-- Vue d'ensemble -->
                    <div class="help-section">
                        <h3 style="margin-bottom:15px;font-size:18px;">üó∫Ô∏è Vue d'ensemble</h3>
                        <div style="background:var(--card-bg);border-radius:15px;padding:22px;box-shadow:0 2px 10px rgba(0,0,0,0.06);margin-bottom:20px;">
                            <p style="line-height:1.8;color:var(--text-secondary);font-size:14px;">
                                <strong style="color:var(--text-color);">Stock Radar</strong> est votre outil complet de gestion de stock pour le e-commerce. Il vous permet de g√©rer vos <strong style="color:var(--text-color);">achats</strong>, votre <strong style="color:var(--text-color);">stock</strong> (neuf, occasion, entrep√¥t, rebut), vos <strong style="color:var(--text-color);">ventes</strong> sur diff√©rentes plateformes (Amazon FBA/FBM, Vinted, Leboncoin), vos <strong style="color:var(--text-color);">fournisseurs</strong> et vos <strong style="color:var(--text-color);">factures</strong>. Toutes les donn√©es sont synchronis√©es en temps r√©el dans le cloud.
                            </p>
                            <div class="help-grid">
                                <div class="help-feature"><div class="help-feature-title">üìä Dashboard</div>Vue d'ensemble : valeur du stock, CA r√©alis√©, b√©n√©fice, r√©partition FBA/FBM/Entrep√¥t, graphiques.</div>
                                <div class="help-feature"><div class="help-feature-title">üè™ Fournisseurs</div>Fiches compl√®tes avec contacts, conditions, historique prix et achats.</div>
                                <div class="help-feature"><div class="help-feature-title">üõí Achats</div>Suivi des commandes, r√©ception automatique vers le stock.</div>
                                <div class="help-feature"><div class="help-feature-title">üßæ Factures</div>Gestion des factures fournisseurs, suivi des √©ch√©ances et paiements.</div>
                                <div class="help-feature"><div class="help-feature-title">üì¶ Stock</div>Vue compl√®te avec filtres avanc√©s, tri par marge/ROI, alertes stock bas.</div>
                                <div class="help-feature"><div class="help-feature-title">üìã Mouvements</div>Journal automatique de toutes les entr√©es, sorties, transferts.</div>
                                <div class="help-feature"><div class="help-feature-title">üîî Alertes</div>D√©tection automatique des produits en rupture ou en stock bas.</div>
                                <div class="help-feature"><div class="help-feature-title">üìä Inventaire</div>Comptage physique avec scan, d√©tection des √©carts, ajustement automatique.</div>
                            </div>
                        </div>
                    </div>

                    <!-- Sections accord√©on -->
                    <div class="help-section">

                        <!-- 1. Premiers pas -->
                        <div class="help-card">
                            <div class="help-card-header" onclick="toggleHelp(this)">
                                <span><span class="help-icon">üöÄ</span> Premiers pas ‚Äî Par o√π commencer ?</span>
                                <span class="help-chevron">‚ñº</span>
                            </div>
                            <div class="help-card-body">
                                <div class="help-step"><div class="help-step-num">1</div><div class="help-step-text"><strong>Ajouter vos fournisseurs</strong> ‚Äî Allez dans <strong>üè™ Fournisseurs</strong> et cliquez <strong>‚ûï Ajouter</strong>. Renseignez au minimum le nom. Vous pourrez compl√©ter la fiche plus tard (contact, conditions, SIRET...).</div></div>
                                <div class="help-step"><div class="help-step-num">2</div><div class="help-step-text"><strong>Enregistrer vos achats</strong> ‚Äî Allez dans <strong>üõí Mes Achats</strong> et cliquez <strong>‚ûï Nouvel achat</strong>. Saisissez l'EAN, le nom du produit, le fournisseur, le prix unitaire et la quantit√©.</div></div>
                                <div class="help-step"><div class="help-step-num">3</div><div class="help-step-text"><strong>R√©ceptionner</strong> ‚Äî Quand la commande arrive, cliquez sur le badge <strong>‚è≥ En attente</strong> pour le passer en <strong>‚úÖ Re√ßu</strong>. Le produit est automatiquement cr√©√© dans le stock.</div></div>
                                <div class="help-step"><div class="help-step-num">4</div><div class="help-step-text"><strong>Compl√©ter la fiche produit</strong> ‚Äî Dans <strong>üì¶ Mon Stock</strong>, cliquez sur un produit pour ouvrir sa fiche. Ajoutez le prix de revente, les canaux de vente, les photos, l'emplacement...</div></div>
                                <div class="help-step"><div class="help-step-num">5</div><div class="help-step-text"><strong>Enregistrer les ventes</strong> ‚Äî Cliquez sur üí∞ pour marquer un produit comme vendu. Renseignez le prix r√©el, la date et le canal de vente.</div></div>
                                <div class="help-tip"><strong>üí° Astuce :</strong> Vous pouvez aussi ajouter un produit directement via <strong>‚ûï Nouveau Produit</strong> sans passer par un achat, en scannant le code-barres ou en saisissant l'EAN manuellement.</div>
                            </div>
                        </div>

                        <!-- 2. Fournisseurs -->
                        <div class="help-card">
                            <div class="help-card-header" onclick="toggleHelp(this)">
                                <span><span class="help-icon">üè™</span> Fournisseurs ‚Äî Fiches compl√®tes</span>
                                <span class="help-chevron">‚ñº</span>
                            </div>
                            <div class="help-card-body">
                                <p>Chaque fournisseur a une <strong>fiche d√©taill√©e</strong> accessible en cliquant sur sa carte. Vous y trouverez :</p>
                                <div class="help-grid">
                                    <div class="help-feature"><div class="help-feature-title">üë§ Coordonn√©es</div>Nom, contact, email, t√©l√©phone, adresse, site web</div>
                                    <div class="help-feature"><div class="help-feature-title">üè¢ Infos entreprise</div>SIRET, TVA intracommunautaire, cat√©gorie (grossiste, fabricant...)</div>
                                    <div class="help-feature"><div class="help-feature-title">üìã Conditions</div>Conditions de paiement, d√©lai livraison, MOQ (minimum de commande), franco de port</div>
                                    <div class="help-feature"><div class="help-feature-title">üìà Historique prix</div>√âvolution des prix par produit au fil du temps, avec % de variation</div>
                                </div>
                                <div class="help-tip"><strong>üí° Astuce :</strong> La fiche fournisseur affiche aussi la liste de ses factures et ses derniers achats. C'est l'endroit id√©al pour avoir une vision compl√®te de votre relation avec ce fournisseur.</div>
                            </div>
                        </div>

                        <!-- 3. Achats -->
                        <div class="help-card">
                            <div class="help-card-header" onclick="toggleHelp(this)">
                                <span><span class="help-icon">üõí</span> Achats ‚Äî Suivi des commandes</span>
                                <span class="help-chevron">‚ñº</span>
                            </div>
                            <div class="help-card-body">
                                <p>La section Achats vous permet de suivre toutes vos commandes fournisseur.</p>
                                <p><strong>Cr√©er un achat :</strong> Renseignez l'EAN, le nom, le fournisseur, le <strong>prix unitaire</strong> HT ou TTC (la conversion est automatique), et la quantit√©.</p>
                                <p><strong>R√©ception :</strong> Quand vous recevez la marchandise, cliquez sur le badge du statut pour basculer de <strong>‚è≥ En attente</strong> √† <strong>‚úÖ Re√ßu</strong>. Cela cr√©e automatiquement le produit dans votre stock avec le bon prix d'achat et la bonne quantit√© en entrep√¥t.</p>
                                <p><strong>Import grossiste :</strong> Vous pouvez importer un fichier Excel ou CSV depuis la section <strong>üì• Import Grossiste</strong> pour enregistrer plusieurs achats en une fois.</p>
                                <div class="help-tip"><strong>üí° Astuce :</strong> Utilisez les filtres pour voir uniquement les achats en attente de r√©ception, ou filtrer par fournisseur. Exportez vos achats en CSV avec le bouton üìä Export.</div>
                            </div>
                        </div>

                        <!-- 4. Factures -->
                        <div class="help-card">
                            <div class="help-card-header" onclick="toggleHelp(this)">
                                <span><span class="help-icon">üßæ</span> Factures ‚Äî Suivi des paiements</span>
                                <span class="help-chevron">‚ñº</span>
                            </div>
                            <div class="help-card-body">
                                <p>Enregistrez vos factures fournisseur pour suivre ce que vous devez payer.</p>
                                <p><strong>Cr√©er une facture :</strong> Num√©ro de facture, fournisseur, date, √©ch√©ance, montant HT/TTC.</p>
                                <p><strong>Statuts automatiques :</strong></p>
                                <div class="help-grid">
                                    <div class="help-feature"><div class="help-feature-title">‚úÖ Pay√©e</div>La facture a √©t√© r√©gl√©e. Cliquez sur üí∞ pour marquer comme pay√©e.</div>
                                    <div class="help-feature"><div class="help-feature-title">üî¥ Impay√©e</div>La facture n'est pas encore r√©gl√©e.</div>
                                    <div class="help-feature"><div class="help-feature-title">‚ö†Ô∏è En retard</div>La date d'√©ch√©ance est d√©pass√©e et la facture n'est toujours pas pay√©e.</div>
                                </div>
                                <div class="help-tip"><strong>üí° Astuce :</strong> Les stats en haut vous montrent le montant total d√ª et le nombre de factures impay√©es. Consultez aussi la fiche fournisseur pour voir ses factures.</div>
                            </div>
                        </div>

                        <!-- 5. Stock -->
                        <div class="help-card">
                            <div class="help-card-header" onclick="toggleHelp(this)">
                                <span><span class="help-icon">üì¶</span> Mon Stock ‚Äî Gestion compl√®te</span>
                                <span class="help-chevron">‚ñº</span>
                            </div>
                            <div class="help-card-body">
                                <p><strong>Onglets de vue :</strong> Filtrez rapidement entre Tout, Neuf, Occasion, Entrep√¥t et Rebut avec les boutons en haut.</p>
                                <p><strong>Les 4 types de stock :</strong></p>
                                <div class="help-grid">
                                    <div class="help-feature"><div class="help-feature-title">üÜï Neuf</div>Produits neufs pr√™ts √† la vente</div>
                                    <div class="help-feature"><div class="help-feature-title">‚ôªÔ∏è Occasion</div>Produits d'occasion ‚Äî quand vous ajoutez un produit occasion, la quantit√© est d√©duite du stock neuf</div>
                                    <div class="help-feature"><div class="help-feature-title">üè≠ Entrep√¥t</div>Vue de tout ce qui est physiquement dans votre entrep√¥t</div>
                                    <div class="help-feature"><div class="help-feature-title">üóëÔ∏è Rebut</div>Produits d√©fectueux ou invendables</div>
                                </div>
                                <p style="margin-top:12px;"><strong>R√©partition des quantit√©s :</strong> Chaque produit a ses quantit√©s r√©parties entre <strong>Amazon FBA</strong>, <strong>Amazon FBM</strong> et <strong>Entrep√¥t</strong>. Utilisez le bouton üîÑ Transf√©rer dans la fiche produit pour d√©placer du stock entre ces emplacements.</p>
                                <p><strong>Colonnes du tableau :</strong> Date, EAN, produit, cat√©gorie, type, quantit√©s FBA/FBM/Entrep√¥t, total, prix d'achat, prix de revente, et <strong>marge</strong> (vert > 30%, orange 10-30%, rouge < 10%).</p>
                                <p><strong>Badges dans le tableau :</strong></p>
                                <div class="help-grid">
                                    <div class="help-feature"><div class="help-feature-title">‚ö†Ô∏è 60j+</div>Badge rouge : stock en entrep√¥t depuis plus de 60 jours ‚Äî risque √©lev√©</div>
                                    <div class="help-feature"><div class="help-feature-title">üïê 30j+</div>Badge orange : stock depuis plus de 30 jours ‚Äî √† surveiller</div>
                                    <div class="help-feature"><div class="help-feature-title">üî¥ / üü†</div>Alertes stock bas si un seuil minimum est d√©fini</div>
                                </div>
                                <p style="margin-top:12px;"><strong>Statuts workflow</strong> (dans la fiche produit) : Re√ßu ‚Üí √Ä contr√¥ler ‚Üí √Ä √©tiqueter ‚Üí √Ä exp√©dier ‚Üí Envoy√© ‚Üí Termin√©. Changez le statut directement depuis la fiche.</p>
                                <p><strong>Emplacement :</strong> Renseignez la localisation physique au format zone/√©tag√®re/bac (ex: <strong>A-03-2</strong>).</p>
                                <div class="help-tip"><strong>üí° Astuce :</strong> Les stats en haut montrent la <strong>valeur achat</strong> (ce que vous avez investi), la <strong>valeur revente</strong> (ce que vous pouvez gagner), la <strong>valeur entrep√¥t</strong> et le <strong>b√©n√©fice potentiel</strong>.</div>
                            </div>
                        </div>

                        <!-- 6. Filtres & Tri -->
                        <div class="help-card">
                            <div class="help-card-header" onclick="toggleHelp(this)">
                                <span><span class="help-icon">üîç</span> Recherche, Filtres & Tri avanc√©</span>
                                <span class="help-chevron">‚ñº</span>
                            </div>
                            <div class="help-card-body">
                                <p><strong>Recherche globale</strong> (barre en haut du site) : Cherche dans tous les produits, achats et fournisseurs en m√™me temps. Tapez un EAN, un nom, un fournisseur ou un mot-cl√©. Les r√©sultats sont cliquables et vous emm√®nent directement au bon endroit.</p>
                                <p><strong>Filtres avanc√©s</strong> (bouton ‚öôÔ∏è dans Mon Stock) :</p>
                                <div class="help-grid">
                                    <div class="help-feature"><div class="help-feature-title">üìÇ Cat√©gorie</div>√âlectronique, Mode, Maison, etc.</div>
                                    <div class="help-feature"><div class="help-feature-title">üì± Plateforme</div>Amazon FBA, FBM, Vinted, Leboncoin</div>
                                    <div class="help-feature"><div class="help-feature-title">üìç Emplacement</div>Entrep√¥t, FBA ou FBM uniquement</div>
                                    <div class="help-feature"><div class="help-feature-title">üìÖ Dates</div>Filtrer par p√©riode (du ... au ...)</div>
                                    <div class="help-feature"><div class="help-feature-title">üè™ Fournisseur</div>Voir les produits d'un fournisseur sp√©cifique</div>
                                    <div class="help-feature"><div class="help-feature-title">üìã Statut</div>Filtrer par statut workflow (Re√ßu, √Ä exp√©dier...)</div>
                                </div>
                                <p style="margin-top:12px;"><strong>Options de tri :</strong> Date, quantit√©, prix, nom, <strong>marge</strong> (meilleure/pire), <strong>ROI</strong> (retour sur investissement), <strong>anciennet√©</strong>, et <strong>‚ö†Ô∏è √Ä risque</strong> (combine anciennet√© + mauvaise marge).</p>
                            </div>
                        </div>

                        <!-- 7. Scanner -->
                        <div class="help-card">
                            <div class="help-card-header" onclick="toggleHelp(this)">
                                <span><span class="help-icon">üì∑</span> Scanner de code-barres</span>
                                <span class="help-chevron">‚ñº</span>
                            </div>
                            <div class="help-card-body">
                                <p>Le scanner utilise la cam√©ra de votre appareil pour lire les codes-barres EAN.</p>
                                <p><strong>Mode continu :</strong> Le scanner ne s'arr√™te pas apr√®s chaque scan ‚Äî vous pouvez encha√Æner plusieurs produits. Appuyez sur ‚èπÔ∏è Stop pour arr√™ter.</p>
                                <p><strong>Retour audio et visuel :</strong></p>
                                <div class="help-grid">
                                    <div class="help-feature"><div class="help-feature-title">‚úÖ Bip aigu + popup vert</div>Code scann√© avec succ√®s, produit non pr√©sent en stock</div>
                                    <div class="help-feature"><div class="help-feature-title">‚ö†Ô∏è Bip moyen + popup orange</div>Produit d√©j√† en stock (doublon) ou code d√©j√† scann√©</div>
                                    <div class="help-feature"><div class="help-feature-title">‚ùå Bip grave</div>Erreur de lecture</div>
                                </div>
                                <p style="margin-top:12px;">Apr√®s le scan, les champs sont <strong>pr√©-remplis automatiquement</strong> si le produit a d√©j√† √©t√© achet√© : nom, cat√©gorie, prix d'achat, prix de revente.</p>
                                <div class="help-tip"><strong>üí° Astuce :</strong> Le scanner fonctionne aussi dans la section <strong>üìä Inventaire</strong> pour le comptage physique.</div>
                            </div>
                        </div>

                        <!-- 8. Alertes -->
                        <div class="help-card">
                            <div class="help-card-header" onclick="toggleHelp(this)">
                                <span><span class="help-icon">üîî</span> Alertes stock bas</span>
                                <span class="help-chevron">‚ñº</span>
                            </div>
                            <div class="help-card-body">
                                <p>D√©finissez un <strong>seuil minimum</strong> par produit. Quand le stock descend en dessous, une alerte appara√Æt.</p>
                                <p><strong>Configurer un seuil :</strong> Ouvrez la fiche d'un produit ‚Üí cliquez ‚úèÔ∏è √âditer ‚Üí champ <strong>"üîî Seuil alerte stock min"</strong>. Ou utilisez le bouton <strong>"‚öôÔ∏è Configurer seuils en lot"</strong> pour appliquer un seuil √† tous les produits d'un coup.</p>
                                <p><strong>Niveaux d'alerte :</strong></p>
                                <div class="help-grid">
                                    <div class="help-feature"><div class="help-feature-title">üî¥ Critique (rupture)</div>Stock = 0 ‚Äî vous ne pouvez plus vendre</div>
                                    <div class="help-feature"><div class="help-feature-title">üü† Stock bas</div>Stock > 0 mais ‚â§ seuil ‚Äî pensez √† recommander</div>
                                    <div class="help-feature"><div class="help-feature-title">üü¢ OK</div>Stock au-dessus du seuil</div>
                                    <div class="help-feature"><div class="help-feature-title">‚ö™ Sans seuil</div>Pas de seuil configur√© ‚Äî pas d'alerte</div>
                                </div>
                            </div>
                        </div>

                        <!-- 9. Inventaire -->
                        <div class="help-card">
                            <div class="help-card-header" onclick="toggleHelp(this)">
                                <span><span class="help-icon">üìä</span> Inventaire / Comptage physique</span>
                                <span class="help-chevron">‚ñº</span>
                            </div>
                            <div class="help-card-body">
                                <div class="help-step"><div class="help-step-num">1</div><div class="help-step-text"><strong>Lancer un inventaire</strong> ‚Äî Cliquez "üÜï Nouvel inventaire". Tous les produits en stock sont charg√©s avec leur quantit√© th√©orique.</div></div>
                                <div class="help-step"><div class="help-step-num">2</div><div class="help-step-text"><strong>Compter</strong> ‚Äî Soit scannez les codes-barres (chaque scan = +1 unit√© compt√©e), soit saisissez les quantit√©s manuellement dans la colonne "Compt√©".</div></div>
                                <div class="help-step"><div class="help-step-num">3</div><div class="help-step-text"><strong>V√©rifier les √©carts</strong> ‚Äî Le tableau affiche en rouge les produits dont le comptage diff√®re du stock th√©orique. Filtrez par "‚ö†Ô∏è √âcarts seulement" pour les voir rapidement.</div></div>
                                <div class="help-step"><div class="help-step-num">4</div><div class="help-step-text"><strong>Valider</strong> ‚Äî Cliquez "‚úÖ Valider & ajuster". Les quantit√©s en stock sont mises √† jour automatiquement et chaque ajustement est enregistr√© dans le journal des mouvements.</div></div>
                                <div class="help-tip"><strong>üí° Astuce :</strong> Exportez les r√©sultats en Excel avant de valider pour garder une trace de l'inventaire. Les √©carts sont ajust√©s sur la quantit√© entrep√¥t.</div>
                            </div>
                        </div>

                        <!-- 10. Export & Sauvegarde -->
                        <div class="help-card">
                            <div class="help-card-header" onclick="toggleHelp(this)">
                                <span><span class="help-icon">üì§</span> Export & Sauvegarde</span>
                                <span class="help-chevron">‚ñº</span>
                            </div>
                            <div class="help-card-body">
                                <p><strong>Export avanc√© :</strong> Choisissez ce que vous voulez exporter (stock complet, filtr√©, achats, vendus, rapport de marge...) et le format (Excel ou CSV).</p>
                                <p><strong>Sauvegarde :</strong> T√©l√©chargez un fichier JSON contenant <strong>toutes</strong> vos donn√©es (fournisseurs, achats, produits, factures). Utile avant une grosse modification.</p>
                                <p><strong>Restauration :</strong> Rechargez un fichier de sauvegarde pour restaurer toutes les donn√©es. Attention : cela <strong>remplace</strong> les donn√©es actuelles.</p>
                                <div class="help-tip"><strong>üí° Astuce :</strong> Faites une sauvegarde r√©guli√®re, surtout avant de valider un inventaire ou de faire des modifications en masse.</div>
                            </div>
                        </div>

                        <!-- 11. Raccourcis clavier -->
                        <div class="help-card">
                            <div class="help-card-header" onclick="toggleHelp(this)">
                                <span><span class="help-icon">‚å®Ô∏è</span> Raccourcis clavier</span>
                                <span class="help-chevron">‚ñº</span>
                            </div>
                            <div class="help-card-body">
                                <div style="display:grid;gap:10px;max-width:400px;">
                                    <div class="help-shortcut"><kbd>Ctrl</kbd> + <kbd>N</kbd> <span style="color:var(--text-secondary);margin-left:8px;">Nouveau produit</span></div>
                                    <div class="help-shortcut"><kbd>Ctrl</kbd> + <kbd>F</kbd> <span style="color:var(--text-secondary);margin-left:8px;">Recherche globale</span></div>
                                    <div class="help-shortcut"><kbd>Ctrl</kbd> + <kbd>S</kbd> <span style="color:var(--text-secondary);margin-left:8px;">Lancer le scanner</span></div>
                                    <div class="help-shortcut"><kbd>Ctrl</kbd> + <kbd>D</kbd> <span style="color:var(--text-secondary);margin-left:8px;">Dashboard</span></div>
                                    <div class="help-shortcut"><kbd>Ctrl</kbd> + <kbd>K</kbd> <span style="color:var(--text-secondary);margin-left:8px;">Mon Stock</span></div>
                                    <div class="help-shortcut"><kbd>Ctrl</kbd> + <kbd>E</kbd> <span style="color:var(--text-secondary);margin-left:8px;">Export Excel rapide</span></div>
                                    <div class="help-shortcut"><kbd>Escape</kbd> <span style="color:var(--text-secondary);margin-left:8px;">Fermer la fen√™tre/modale</span></div>
                                </div>
                            </div>
                        </div>

                        <!-- 12. Ventes & Plateformes -->
                        <div class="help-card">
                            <div class="help-card-header" onclick="toggleHelp(this)">
                                <span><span class="help-icon">üí∞</span> Ventes & Plateformes</span>
                                <span class="help-chevron">‚ñº</span>
                            </div>
                            <div class="help-card-body">
                                <p><strong>Enregistrer une vente :</strong> Cliquez sur üí∞ dans le tableau stock ou dans la fiche produit. Renseignez le prix de vente r√©el, la date, la quantit√© vendue et le canal.</p>
                                <p><strong>Canaux support√©s :</strong> Amazon FBA, Amazon FBM, Vinted, Leboncoin, Autre. La quantit√© est d√©duite automatiquement du bon emplacement (FBA, FBM ou entrep√¥t selon le canal).</p>
                                <p><strong>G√©n√©rer une annonce :</strong> Dans la fiche produit, les boutons üìù Vinted et üìù Leboncoin g√©n√®rent un texte d'annonce pr√™t √† copier-coller avec le nom, l'√©tat, le prix et les d√©tails du produit.</p>
                                <p><strong>Suivi des performances :</strong> Le Dashboard affiche le CA r√©alis√©, le b√©n√©fice total, la marge moyenne et la r√©partition du CA par canal.</p>
                            </div>
                        </div>

                    </div>

                    <!-- Footer aide -->
                    <div style="background:var(--card-bg);border-radius:15px;padding:22px;box-shadow:0 2px 10px rgba(0,0,0,0.06);text-align:center;margin-top:10px;">
                        <p style="font-size:15px;font-weight:700;margin-bottom:8px;">üõ°Ô∏è Stock Radar v2</p>
                        <p style="color:var(--text-secondary);font-size:13px;">Application de gestion de stock e-commerce ¬∑ Donn√©es synchronis√©es en temps r√©el via Supabase ¬∑ H√©berg√© sur GitHub Pages</p>
                        <p style="color:var(--text-secondary);font-size:13px;margin-top:8px;">Un probl√®me ? Contactez l'administrateur de votre compte.</p>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!-- Floating scan button (mobile) -->
    <button class="fab-scan" id="fab-scan" onclick="openQuickScan()">üì∑</button>

    <!-- Quick Scan Overlay -->
    <div class="quick-scan-overlay" id="quick-scan-overlay">
        <div class="quick-scan-header">
            <h3>üì∑ Scan rapide</h3>
            <button class="quick-scan-close" onclick="closeQuickScan()">‚úï</button>
        </div>
        <div class="quick-scan-video-box">
            <video id="quick-scan-video" autoplay playsinline></video>
            <div class="quick-scan-viewfinder"></div>
        </div>
        <div class="quick-scan-result" id="quick-scan-result">Pointez la cam√©ra vers un code-barres...</div>
        <div class="quick-scan-actions">
            <button style="background:#27352a;color:white;" onclick="quickScanAction('nouveau')">‚ûï Nouveau produit</button>
            <button style="background:#3498db;color:white;" onclick="quickScanAction('stock')">üì¶ Voir en stock</button>
            <button style="background:#f39c12;color:white;" onclick="quickScanAction('inventaire')">üìä Inventaire</button>
        </div>
        <div class="quick-scan-history" id="quick-scan-history"></div>
    </div>

    <div id="fournisseur-modal" class="modal">
        <div class="modal-content wide">
            <span class="close-modal" onclick="closeFournisseurModal()">&times;</span>
            <div id="fournisseur-modal-body"></div>
        </div>
    </div>

    <!-- Modal Fiche Produit -->
    <div id="product-modal" class="modal">
        <div class="modal-content wide">
            <span class="close-modal" onclick="closeProductModal()">&times;</span>
            <div id="product-modal-body"></div>
        </div>
    </div>

    <!-- Modal Vente -->
    <div id="vente-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeVenteModal()">&times;</span>
            <h2>üí∞ Marquer comme vendu</h2>
            <div id="vente-product-info" style="background:var(--filter-bg);padding:12px 16px;border-radius:10px;margin-bottom:20px;font-size:14px;"></div>
            <form id="vente-form">
                <div class="form-row">
                    <div class="form-group"><label>Prix de vente unitaire (‚Ç¨) *</label><input type="number" id="vente-prix" step="0.01" required placeholder="0.00"></div>
                    <div class="form-group"><label>Quantit√© vendue *</label><input type="number" id="vente-qte" min="1" value="1" required style="font-size:18px;font-weight:700;text-align:center;"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Date de vente *</label><input type="date" id="vente-date" required></div>
                    <div class="form-group"><label>Canal de vente *</label>
                        <select id="vente-plateforme" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Amazon FBA">Amazon FBA</option>
                            <option value="Amazon FBM">Amazon FBM</option>
                            <option value="Vinted">Vinted</option>
                            <option value="Leboncoin">Leboncoin</option>
                            <option value="Autre">Autre</option>
                        </select>
                    </div>
                </div>
                <div id="vente-total-display" style="background:var(--filter-bg);padding:12px 16px;border-radius:10px;margin:15px 0;text-align:center;font-size:16px;font-weight:700;"></div>
                <button type="submit" class="submit-button">‚úÖ Confirmer la vente</button>
            </form>
        </div>
    </div>

    <!-- Modal Annonce -->
    <div id="annonce-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeAnnonceModal()">&times;</span>
            <h2 id="modal-title">Annonce</h2>
            <div class="annonce-preview" id="annonce-text"></div>
            <button class="copy-button" onclick="copyAnnonce()">üìã Copier</button>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/@zxing/library@0.20.0/umd/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="config.js"></script>
    <script src="app-cloud.js"></script>
    <script src="auth.js"></script>
    <script>
        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("sw.js").then(reg => {
                console.log('SW registered:', reg.scope);
            }).catch(err => console.warn('SW failed:', err));
        }
    </script>
</body>
</html>
